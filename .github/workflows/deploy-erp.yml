# =============================================================================
# GitHub Actions - Deploy ERP System Only
# =============================================================================
# Workflow khusus untuk deploy folder ERP saja
#
# SETUP SECRETS:
# - FTP_SERVER   : ftp.yourdomain.com
# - FTP_USERNAME : username FTP 
# - FTP_PASSWORD : password FTP
# - FTP_PATH_ERP : /public_html/erp/ (atau subdomain path)
# =============================================================================

name: ðŸš€ Deploy ERP System

on:
  push:
    branches:
      - main
      - master
    paths:
      # Hanya trigger jika ada perubahan di folder ERP
      - 'erp sistem/**'
  
  workflow_dispatch:

jobs:
  deploy-erp:
    name: ðŸ“¦ Deploy ERP
    runs-on: ubuntu-latest
    
    steps:
      - name: ðŸ“¥ Checkout Repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: ðŸ“¤ Deploy ERP via FTP
        uses: SamKirkland/FTP-Deploy-Action@v4.3.5
        with:
          server: ${{ secrets.FTP_SERVER }}
          username: ${{ secrets.FTP_USERNAME }}
          password: ${{ secrets.FTP_PASSWORD }}
          server-dir: ${{ secrets.FTP_PATH_ERP }}
          local-dir: "./erp sistem/"
          
          exclude: |
            **/.git*
            **/.git*/**
            **/writable/logs/**
            **/writable/cache/**
            **/writable/session/**
            **/writable/debugbar/**
            **/.env
            **/composer.lock
            **/*.log
            **/preview/**

      - name: âœ… ERP Deployed
        if: success()
        run: |
          echo "ðŸŽ‰ ERP System deployed successfully!"
          echo "ðŸ“… Time: $(date)"
